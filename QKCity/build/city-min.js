/**
 * QKCity
 *
 * @author  zfkun<zfkun.com>
 */
(function(f,g,e){var d;function i(k){return typeof k==="string"?document.getElementById(k):k}function a(k,m,l){if(k.addEventListener){k.addEventListener(m,l,false)}else{if(k.attachEvent){k.attachEvent("on"+m,l)}else{k["on"+m]=l}}}function j(k){return k&&Object.prototype.toString.call(k)==="[object Object]"&&"isPrototypeOf" in k}function h(m,l){var k,o;if(j(m)){for(k in m){l(m[k],k)}}else{if(m){o=m.length;for(k=0;k<o;k++){l(m[k],k)}}}}function c(k){return k&&(k.tagName||"").toLowerCase()==="select"&&!k.disabled}function b(n,l,m){var k=this,o;if(!(k instanceof b)){return new b(n,l,m)}if(!n||!n.length){return k}o=j(m)?m:{};k.offEmpty=!!o.offEmpty;k.selects=[];k.binds=[];k.emptyTexts=[];h(n,function(p,q){var r=k.selects[q]=i(p);a(r,"change",k.binds[q]=function(){b.update(k,q,true)});if(!k.offEmpty){r.options.add(new Option(k.emptyTexts[q]=r.getAttribute("data-emptyText")||b.emptyText,0))}r=null});b.fill(k,0,true,0,l?l[0]:0);b.update(k,0,true,l);return k}b.fill=function(q,m,o,r,p){var l,k;if(!q||!q.selects||!(l=q.selects[m])){return}if(o){l.options.length=0}if(!q.offEmpty){l.options.add(new Option(q.emptyTexts[m],0))}var n=q.offEmpty?-1:0;h(b.getCitys(m,r),function(s){l.options.add(new Option(s.name,s.id));++n;if(p>0&&p===s.id){k=n}});l.selectedIndex=k||0;l.disabled=l.options.length<=(q.offEmpty?0:1);n=l=null};b.update=function(o,k,m,p){var n=k+1,l,q;if((l=o.selects)&&l[k]&&l[n]){q=(p?p[n]:0)||0;b.fill(o,n,m,l[k].value||0,q);if(l[n+1]){b.update(o,n,m,p)}}};b.getCitys=function(l,n){var k;if(l>0&&n<=0){return[]}d=d||[];if(!d[0]){k=d[0]={};h(b.DATAS,function(p,o){k[p.id]=p})}for(var m=1;m<=l;m++){if(!d[m]){k=d[m]={};h(d[m-1],function(o){h(o.child||[],function(p){k[p.id]=p})})}}return n>0?(d[l-1][n]||{}).child||[]:d[l]};b.emptyText="-\u8BF7\u9009\u62E9-";g.QKCity=b})(null,window);