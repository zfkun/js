/**
 * QKCity
 *
 * @author  zfkun<zfkun.com>
 */
(function(c){var a;function h(i){return typeof i==="string"?document.getElementById(i):i}function f(i,k,j){if(i.addEventListener){i.addEventListener(k,j,false)}else{if(i.attachEvent){i.attachEvent("on"+k,j)}else{i["on"+k]=j}}}function g(i){return i&&Object.prototype.toString.call(i)==="[object Object]"&&"isPrototypeOf" in i}function e(l,k){var j,m;if(g(l)){for(j in l){k(l[j],j)}}else{if(l){m=l.length;for(j=0;j<m;j++){k(l[j],j)}}}}function b(i){return i&&(i.tagName||"").toLowerCase()==="select"&&!i.disabled}function d(l,j,k){var i=this,m;if(!(i instanceof d)){return new d(l,j,k)}if(!l||!l.length){return i}m=g(k)?k:{};i.offEmpty=!!m.offEmpty;i.selects=[];i.binds=[];i.emptyTexts=[];e(l,function(n,o){var p=i.selects[o]=h(n);f(p,"change",i.binds[o]=function(){d.update(i,o,true)});if(!i.offEmpty){p.options.add(new Option(i.emptyTexts[o]=p.getAttribute("data-emptyText")||d.emptyText,0))}p=null});d.fill(i,0,true,0,0,j?j[0]:0);d.update(i,0,true,j);return i}d.fill=function(q,m,n,j,r,o){var p,k;if(!q||!q.selects||!(p=q.selects[m])){return}if(n){p.options.length=0}if(!q.offEmpty){p.options.add(new Option(q.emptyTexts[m],0))}var l=q.offEmpty?-1:0;e(d.getCitys(m,j,r),function(i){p.options.add(new Option(i.name,i.id));++l;if(o>0&&o==i.id){k=l}});p.selectedIndex=k||0;p.disabled=p.options.length<=(q.offEmpty?0:1);l=p=null};d.update=function(m,i,k,n){var l=i+1,j,o;if((j=m.selects)&&j[i]&&j[l]){o=(n?n[l]:0)||0;d.fill(m,l,k,j[i].value||0,(i>0?j[i-1].value||0:j[i].value||0),o);if(j[l+1]){d.update(m,l,k,n)}}};d.getCitys=function(k,m,l){var j={},i;switch(k){case 0:i=d.DATAS;break;case 1:i=d.DATAS[m];break;case 2:i=(d.DATAS[l]||{})[m];break}e(i||{},function(o,n){if(n!=="n"&&n>0){j[n]={id:n|0,name:o.n}}});return j};d.emptyText="-\u8BF7\u9009\u62E9-";c.QKCity=d})(window);